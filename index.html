<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>南部町ローソン 業務チェックリスト</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
  * { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    /* ベースフォント（小＝今のサイズ相当） */
    --font-small: 11px;
    --font-medium: 13px;
    --font-large: 15px;
  }

  body {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    background: #f5f5f5;
    color: #111;
    line-height: 1.6;
    font-size: var(--font-small);  /* デフォルト：小 */
  }
  body.font-medium {
    font-size: var(--font-medium);
  }
  body.font-large {
    font-size: var(--font-large);
  }

  /* 幅広め */
  .app {
    max-width: 1400px;
    margin: 0 auto;
    padding-bottom: 80px;
  }

  header {
    position: sticky;
    top: 0;
    z-index: 10;
    background: #111;
    color: #fff;
    padding: 10px 14px;
  }
  header h1 {
    font-size: 1.45em; /* 元16px */
    font-weight: 600;
  }
  header p {
    font-size: 1em; /* 元11px */
    opacity: 0.85;
    margin-top: 2px;
  }

  /* ナビ（時間帯ジャンプ） */
  .nav {
    display: flex;
    overflow-x: auto;
    gap: 6px;
    padding: 8px 10px 4px;
    background: #222;
    scrollbar-width: none;
  }
  .nav::-webkit-scrollbar { display: none; }
  .nav a {
    flex: 0 0 auto;
    padding: 4px 8px;
    font-size: 1em; /* 元11px */
    border-radius: 999px;
    border: 1px solid #555;
    color: #eee;
    text-decoration: none;
    white-space: nowrap;
  }
  .nav a:hover {
    background: #fff;
    color: #111;
  }

  /* 文字サイズ切り替え */
  .font-size-selector {
    display: flex;
    gap: 6px;
    padding: 6px 10px 4px;
    background: #111;
    border-top: 1px solid #333;
  }
  .font-size-selector button {
    padding: 3px 10px;
    font-size: 0.95em;
    background: #222;
    border: 1px solid #555;
    border-radius: 999px;
    color: #eee;
    cursor: pointer;
  }
  .font-size-selector button:hover {
    background: #444;
  }
  .font-size-selector button.active {
    background: #fff;
    color: #111;
    border-color: #fff;
  }

  main { padding: 10px 12px 20px; }

  .slot {
    margin-bottom: 12px;
    background: #fff;
    border-radius: 10px;
    padding: 10px 10px 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.06);
  }

  .slot-header {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    margin-bottom: 4px;
    border-bottom: 1px solid #eee;
    padding-bottom: 4px;
  }
  .slot-title {
    font-size: 1.27em; /* 元14px */
    font-weight: 600;
  }
  .slot-note {
    font-size: 0.9em; /* 元10px */
    color: #666;
  }

  .tasks-group {
    margin-top: 6px;
  }
  .tasks-group h3 {
    font-size: 1.1em; /* 元12px */
    display: inline-flex;
    align-items: center;
    gap: 4px;
    margin-bottom: 4px;
  }
  .badge {
    font-size: 0.9em; /* 元10px */
    padding: 1px 6px;
    border-radius: 999px;
  }
  .badge-a {
    background: #111;
    color: #fff;
  }
  .badge-b {
    background: #e0e0e0;
    color: #333;
  }

  ul.tasks {
    list-style: none;
    padding-left: 10px;
    border-left: 2px solid #111;
    margin-bottom: 4px;
  }
  ul.tasks.b {
    border-left-color: #bbb;
  }

  /* li→チェック付きの行 */
  .task-item {
    display: flex;
    align-items: flex-start;
    gap: 6px;
    font-size: 1em; /* 元11px */
    padding: 2px 0;
  }
  .task-item input[type="checkbox"] {
    margin-top: 2px;
  }
  .task-text {
    flex: 1;
  }

  .footer-note {
    font-size: 0.9em; /* 元10px */
    color: #666;
    padding: 6px 4px 20px;
    text-align: center;
  }

  /* ===== お知らせ・引き継ぎ用 ===== */

  .info-list {
    list-style: none;
    font-size: 1em; /* 元11px */
    padding-left: 4px;
  }
  .info-list li {
    padding: 2px 0;
  }

  .handover {
    margin-top: 4px;
  }
  .handover-title {
    font-size: 1.18em; /* 元13px */
    font-weight: 600;
    margin-bottom: 4px;
  }
  .handover-note {
    font-size: 0.9em; /* 元10px */
    color: #666;
    margin-bottom: 4px;
  }

  .handover-chips {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    margin-bottom: 6px;
  }
  .handover-chips button {
    border: 1px solid #ccc;
    border-radius: 999px;
    padding: 3px 8px;
    font-size: 0.9em; /* 元10px */
    background: #fafafa;
    cursor: pointer;
  }
  .handover-chips button:hover {
    background: #eee;
  }

  .handover-log {
    list-style: none;
    font-size: 1em; /* 元11px */
    border-top: 1px dashed #ddd;
    padding-top: 4px;
  }
  .handover-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 2px 0;
  }
  .handover-text {
    flex: 1;
    margin-right: 6px;
  }
  .handover-time {
    font-size: 0.9em; /* 元10px */
    color: #666;
    margin-right: 4px;
  }
  .handover-remove {
    border: none;
    background: transparent;
    font-size: 1.1em;
    cursor: pointer;
    color: #999;
  }
  .handover-remove:hover {
    color: #f33;
  }

  .handover-clear {
    margin-top: 4px;
    text-align: right;
  }
  .handover-clear button {
    border: none;
    background: #eee;
    border-radius: 999px;
    padding: 2px 8px;
    font-size: 0.9em; /* 元10px */
    cursor: pointer;
  }


.device-label-bar {
  margin-top: 8px;
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  align-items: center;
  font-size: 12px;
}

.device-label-title {
  font-weight: 600;
}

.device-label-display {
  padding: 2px 8px;
  border-radius: 999px;
  background: #222;
  color: #fff;
  font-size: 11px;
}

.device-label-input {
  flex: 1;
  min-width: 140px;
  max-width: 220px;
  padding: 4px 8px;
  border-radius: 999px;
  border: 1px solid #ccc;
  font-size: 12px;
}

.device-label-save-btn {
  padding: 4px 10px;
  border-radius: 999px;
  border: none;
  font-size: 12px;
  background: #1f7aec;
  color: #fff;
  cursor: pointer;
}

.device-label-save-btn:hover {
  opacity: 0.9;
}



    
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>南部町ローソン 業務チェック</h1>
      <p>時間帯ごとの A＝必須 / B＝余裕あれば。迷ったらAから。</p>

 <div class="device-label-bar">
    <span class="device-label-title">名前を入力：</span>
    <span id="deviceLabelDisplay" class="device-label-display">未設定</span>

    <input
      id="deviceLabelInput"
      class="device-label-input"
      type="text"
      placeholder="例：たなか"
    />
    <button id="deviceLabelSaveBtn" class="device-label-save-btn">
      保存
    </button>
  </div>
      
      <nav class="nav">
        <a href="#t6-8">6〜8時</a>
        <a href="#t9-11">9〜11時</a>
        <a href="#t12-14">12〜14時</a>
        <a href="#t15-17">15〜17時</a>
        <a href="#t18-20">18〜20時</a>
        <a href="#t21-23">21〜23時</a>
        <a href="#t0-2">0〜2時</a>
        <a href="#t3-5">3〜5時</a>
      </nav>

      <!-- 🔤 文字サイズ切り替え -->
      <div class="font-size-selector">
        <button data-size="small">小</button>
        <button data-size="medium">中</button>
        <button data-size="large">大</button>
      </div>
    </header>

    <main>
      <!-- 現在時刻表示 -->
      <div id="time-display" style="padding: 10px; color: #333;">
        時刻を読み込み中…
      </div>

      <!-- ★ お知らせ（経営者専用 ownerNews）★ -->
      <section class="slot">
        <div class="slot-header">
          <div class="slot-title">お知らせ</div>
          <div class="slot-note">経営者からの共有事項</div>
        </div>
        <div class="tasks-group">
          <h3><span class="badge badge-a">お知らせ</span></h3>
          <ul class="info-list" id="notice-list">
            <li>お知らせを読み込み中...</li>
          </ul>
        </div>
      </section>

      <!-- 6〜8時 -->
      <section id="t6-8" class="slot">
        <div class="slot-header">
          <div class="slot-title">6:00〜8:00</div>
          <div class="slot-note">朝の立ち上げ</div>
        </div>

        <div class="tasks-group">
          <h3><span class="badge badge-a">A 必須</span> この時間に必ずやること</h3>
          <ul class="tasks a">
            <li>
              <label class="task-item">
                <input type="checkbox">
                <span class="task-text">CDC納品・片づけ（2便）</span>
              </label>
            </li>
            <li>
              <label class="task-item">
                <input type="checkbox">
                <span class="task-text">ベーカリー納品・片づけ（2便）</span>
              </label>
            </li>
            <li>
              <label class="task-item">
                <input type="checkbox">
                <span class="task-text">コーヒーマシン清掃（本体・コンディメント什器・周辺）</span>
              </label>
            </li>
            <li>
              <label class="task-item">
                <input type="checkbox">
                <span class="task-text">トイレ点検</span>
              </label>
            </li>
            <li>
              <label class="task-item">
                <input type="checkbox">
                <span class="task-text">ポットのお湯確認</span>
              </label>
            </li>
            <li>
              <label class="task-item">
                <input type="checkbox">
                <span class="task-text">店内・店頭ゴミ袋の点検・交換</span>
              </label>
            </li>
            <li>
              <label class="task-item">
                <input type="checkbox">
                <span class="task-text">温度チェック</span>
              </label>
            </li>
          </ul>
        </div>

        <div class="tasks-group">
          <h3><span class="badge badge-b">B 余裕</span> 時間が余ったときにできたら助かること</h3>
          <ul class="tasks b">
            <li>
              <label class="task-item">
                <input type="checkbox">
                <span class="task-text">店内・店頭ゴミ箱の清掃</span>
              </label>
            </li>
            <li>
              <label class="task-item">
                <input type="checkbox">
                <span class="task-text">サービスコーナー（Loppi・ATM・コピー機）・イートイン清掃</span>
              </label>
            </li>
          </ul>
        </div>
      </section>

      <!-- ★ 6〜8時のあとに 引き継ぎメモ ★ -->
      <section class="slot handover-slot" data-slot="t6-8">
        <div class="slot-header">
          <div class="slot-title">引き継ぎメモ（全員で共有）</div>
          <div class="slot-note">時間帯をまたぐ時の共有メモ</div>
        </div>

        <div class="handover">
          <p class="handover-note">
            文章を書くのがだるい人向け。下のボタンをタップするとメモに追加されます。
          </p>
          <div class="handover-chips"></div>
          <ul class="handover-log"></ul>
          <div class="handover-clear">
            <button type="button" class="handover-clear-btn">メモを全部消す</button>
          </div>
        </div>
      </section>

      <!-- 9〜11時 -->
      <section id="t9-11" class="slot">
        <div class="slot-header">
          <div class="slot-title">9:00〜11:00</div>
          <div class="slot-note">午前帯</div>
        </div>

        <div class="tasks-group">
          <h3><span class="badge badge-a">A 必須</span> この時間に必ずやること</h3>
          <ul class="tasks a">
            <li><label class="task-item"><input type="checkbox"><span class="task-text">トイレ点検</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">12時締め発注</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">床清掃</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">プライスカード取り付け</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">ポットのお湯確認</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">レジ点検（現金・金券）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">コーヒーマシン清掃（本体・コンディメント・周辺）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">店舗周辺の清掃</span></label></li>
          </ul>
        </div>

        <div class="tasks-group">
          <h3><span class="badge badge-b">B 余裕</span> 時間が余ったときにできたら助かること</h3>
          <ul class="tasks b">
            <li><label class="task-item"><input type="checkbox"><span class="task-text">店内・店頭ゴミ袋の点検・交換</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">消耗品発注（必要あれば）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">FF・厨房原料 使用期限チェック</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">灰皿清掃</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">前陳（ソフトドリンク・冷蔵酒・菓子・即席麺）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">床清掃（2回目）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">品出し（ソフトドリンク・冷蔵酒）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">補充（たばこ）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">FF販売許容確認・廃棄</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">ホット/常温FF作成（昼）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">マチカフェ販売準備（アイスカップ補充など）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">トイレ清掃（1日1回）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">隙あらば前陳（米飯・オープンケース・デザート・ベーカリー）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">月曜のみ：新商品販促物設置</span></label></li>
          </ul>
        </div>
      </section>

      <!-- 9〜11時後の引き継ぎメモ -->
      <section class="slot handover-slot" data-slot="t9-11">
        <div class="slot-header">
          <div class="slot-title">引き継ぎメモ（全員で共有）</div>
          <div class="slot-note">時間帯をまたぐ時の共有メモ</div>
        </div>

        <div class="handover">
          <p class="handover-note">
            文章を書くのがだるい人向け。下のボタンをタップするとメモに追加されます。
          </p>
          <div class="handover-chips"></div>
          <ul class="handover-log"></ul>
          <div class="handover-clear">
            <button type="button" class="handover-clear-btn">メモを全部消す</button>
          </div>
        </div>
      </section>

      <!-- 12〜14時 -->
      <section id="t12-14" class="slot">
        <div class="slot-header">
          <div class="slot-title">12:00〜14:00</div>
          <div class="slot-note">昼帯</div>
        </div>

        <div class="tasks-group">
          <h3><span class="badge badge-a">A 必須</span> この時間に必ずやること</h3>
          <ul class="tasks a">
            <li><label class="task-item"><input type="checkbox"><span class="task-text">CDC納品・片づけ（3便）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">前陳（ソフトドリンク・冷蔵酒、菓子・即席麺）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">ポットのお湯確認</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">14時オープンケース廃棄（米飯・調理パン・ベーカリー）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">廃棄登録</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">コーヒーマシン清掃</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">トイレ清掃（1日1回）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">伝票整理</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">送金</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">灰皿清掃</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">補充（ホットドリンク）</span></label></li>
          </ul>
        </div>

        <div class="tasks-group">
          <h3><span class="badge badge-b">B 余裕</span> 時間が余ったときにできたら助かること</h3>
          <ul class="tasks b">
            <li><label class="task-item"><input type="checkbox"><span class="task-text">隙あらば前陳（米飯・オープンケース・デザート・ベーカリー）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">品出し（菓子・即席麺・ドリンク剤・アイス・冷凍食品）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">店内・店頭ゴミ箱の清掃</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">床清掃</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">ダスタークロスがけ</span></label></li>
          </ul>
        </div>
      </section>

      <!-- 12〜14時後の引き継ぎメモ -->
      <section class="slot handover-slot" data-slot="t12-14">
        <div class="slot-header">
          <div class="slot-title">引き継ぎメモ（全員で共有）</div>
          <div class="slot-note">時間帯をまたぐ時の共有メモ</div>
        </div>

        <div class="handover">
          <p class="handover-note">
            文章を書くのがだるい人向け。下のボタンをタップするとメモに追加されます。
          </p>
          <div class="handover-chips"></div>
          <ul class="handover-log"></ul>
          <div class="handover-clear">
            <button type="button" class="handover-clear-btn">メモを全部消す</button>
          </div>
        </div>
      </section>

      <!-- 15〜17時 -->
      <section id="t15-17" class="slot">
        <div class="slot-header">
          <div class="slot-title">15:00〜17:00</div>
          <div class="slot-note">夕方前</div>
        </div>

        <div class="tasks-group">
          <h3><span class="badge badge-a">A 必須</span> この時間に必ずやること</h3>
          <ul class="tasks a">
            <li><label class="task-item"><input type="checkbox"><span class="task-text">隙あらば前陳（米飯・オープンケース・デザート・ベーカリー）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">前陳（アイス・冷凍食品、ソフトドリンク・冷蔵酒、菓子・即席麺）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">補充（たばこ）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">FF販売許容確認・廃棄</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">ホット・常温FF作成（夕）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">トイレ点検</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">店舗周辺の清掃</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">温度チェック</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">たばこ納品・片づけ</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">中華まん作成（昼）</span></label></li>
          </ul>
        </div>

        <div class="tasks-group">
          <h3><span class="badge badge-b">B 余裕</span> 時間が余ったときにできたら助かること</h3>
          <ul class="tasks b">
            <li><label class="task-item"><input type="checkbox"><span class="task-text">レジ点検</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">ダスタークロスがけ</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">入口ドア拭き上げ</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">月曜のみ：販促物設置</span></label></li>
          </ul>
        </div>
      </section>

      <!-- 15〜17時後の引き継ぎメモ -->
      <section class="slot handover-slot" data-slot="t15-17">
        <div class="slot-header">
          <div class="slot-title">引き継ぎメモ（全員で共有）</div>
          <div class="slot-note">時間帯をまたぐ時の共有メモ</div>
        </div>

        <div class="handover">
          <p class="handover-note">
            文章を書くのがだるい人向け。下のボタンをタップするとメモに追加されます。
          </p>
          <div class="handover-chips"></div>
          <ul class="handover-log"></ul>
          <div class="handover-clear">
            <button type="button" class="handover-clear-btn">メモを全部消す</button>
          </div>
        </div>
      </section>

      <!-- 18〜20時 -->
      <section id="t18-20" class="slot">
        <div class="slot-header">
          <div class="slot-title">18:00〜20:00</div>
          <div class="slot-note">夕方〜夜</div>
        </div>

        <div class="tasks-group">
          <h3><span class="badge badge-a">A 必須</span> この時間に必ずやること</h3>
          <ul class="tasks a">
            <li><label class="task-item"><input type="checkbox"><span class="task-text">店内・店頭ゴミ袋の点検・交換</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">トイレ清掃（1日1回）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">前陳（菓子・即席麺、ソフトドリンク・冷蔵酒）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">トイレ点検</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">店舗周辺の清掃</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">コーヒーマシン清掃</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">油の酸価度チェック</span></label></li>
          </ul>
        </div>

        <div class="tasks-group">
          <h3><span class="badge badge-b">B 余裕</span> 時間が余ったときにできたら助かること</h3>
          <ul class="tasks b">
            <li><label class="task-item"><input type="checkbox"><span class="task-text">雑誌・書籍メンテ</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">夕刊返品</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">ホット・常温FF作成（夜）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">製氷機清掃（水・土）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">棚清掃（日用品1台）（水・土）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">床清掃</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">ダスタークロスがけ</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">返本</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">店頭（軒下・ガラス面）清掃（水・土）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">店内・店頭ゴミ箱清掃</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">20時オープンケース廃棄（長鮮度おにぎり・長鮮手巻）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">店外/店内マット清掃（水・土）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">冷凍機器清掃（水）</span></label></li>
          </ul>
        </div>
      </section>

      <!-- 18〜20時後の引き継ぎメモ -->
      <section class="slot handover-slot" data-slot="t18-20">
        <div class="slot-header">
          <div class="slot-title">引き継ぎメモ（全員で共有）</div>
          <div class="slot-note">時間帯をまたぐ時の共有メモ</div>
        </div>

        <div class="handover">
          <p class="handover-note">
            文章を書くのがだるい人向け。下のボタンをタップするとメモに追加されます。
          </p>
          <div class="handover-chips"></div>
          <ul class="handover-log"></ul>
          <div class="handover-clear">
            <button type="button" class="handover-clear-btn">メモを全部消す</button>
          </div>
        </div>
      </section>

      <!-- 21〜23時 -->
      <section id="t21-23" class="slot">
        <div class="slot-header">
          <div class="slot-title">21:00〜23:00</div>
          <div class="slot-note">夜帯</div>
        </div>

        <div class="tasks-group">
          <h3><span class="badge badge-a">A 必須</span> この時間に必ずやること</h3>
          <ul class="tasks a">
            <li><label class="task-item"><input type="checkbox"><span class="task-text">補充（たばこ）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">DDC納品・片づけ（※水・土はDDC無し → 掃除の日）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">22時オープンケース廃棄（米飯・調理パン・チルド弁当・調理麺…）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">マチカフェ販売準備（アイスカップ）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">トイレ点検</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">灰皿清掃</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">温度チェック</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">トイレ点検（再）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">0時オープンケース廃棄（次時間帯へ）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">ホットドリンク販売許容確認・廃棄</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">廃棄登録</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">コーヒーマシン清掃（本体クリーニング）</span></label></li>
          </ul>
        </div>

        <div class="tasks-group">
          <h3><span class="badge badge-b">B 余裕</span> 時間が余ったときにできたら助かること</h3>
          <ul class="tasks b">
            <li><label class="task-item"><input type="checkbox"><span class="task-text">店内販促物設置（新商品納品日でない日）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">トイレ清掃（1日1回）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">平場販売許容確認・廃棄</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">フィルター・吸込口・換気扇清掃（水・土）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">フライヤー清掃・油交換（水・土）</span></label></li>
          </ul>
        </div>
      </section>

      <!-- 21〜23時後の引き継ぎメモ -->
      <section class="slot handover-slot" data-slot="t21-23">
        <div class="slot-header">
          <div class="slot-title">引き継ぎメモ（全員で共有）</div>
          <div class="slot-note">時間帯をまたぐ時の共有メモ</div>
        </div>

        <div class="handover">
          <p class="handover-note">
            文章を書くのがだるい人向け。下のボタンをタップするとメモに追加されます。
          </p>
          <div class="handover-chips"></div>
          <ul class="handover-log"></ul>
          <div class="handover-clear">
            <button type="button" class="handover-clear-btn">メモを全部消す</button>
          </div>
        </div>
      </section>

      <!-- 0〜2時 -->
      <section id="t0-2" class="slot">
        <div class="slot-header">
          <div class="slot-title">0:00〜2:00</div>
          <div class="slot-note">深夜前半</div>
        </div>

        <div class="tasks-group">
          <h3><span class="badge badge-a">A 必須</span> この時間に必ずやること</h3>
          <ul class="tasks a">
            <li><label class="task-item"><input type="checkbox"><span class="task-text">FDC納品・片づけ</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">温度チェック</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">検収印日付変更</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">精算</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">コピー機精算・用紙補充（入金含む）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">雑誌納品・片づけ</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">FF什器清掃（中華まん）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">FF販売許容確認・廃棄</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">ホットドリンク販売許容確認・廃棄</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">1時オープンケース廃棄（米飯・調理パン）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">平場販売許容確認・廃棄</span></label></li>
          </ul>
        </div>

        <div class="tasks-group">
          <h3><span class="badge badge-b">B 余裕</span> 時間が余ったときにできたら助かること</h3>
          <ul class="tasks b">
            <li><label class="task-item"><input type="checkbox"><span class="task-text">カウンター清掃</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">深夜時間帯の紙幣確認・調整</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">レジ・カウンター周辺清掃</span></label></li>
          </ul>
        </div>
      </section>

      <!-- 0〜2時後の引き継ぎメモ -->
      <section class="slot handover-slot" data-slot="t0-2">
        <div class="slot-header">
          <div class="slot-title">引き継ぎメモ（全員で共有）</div>
          <div class="slot-note">時間帯をまたぐ時の共有メモ</div>
        </div>

        <div class="handover">
          <p class="handover-note">
            文章を書くのがだるい人向け。下のボタンをタップするとメモに追加されます。
          </p>
          <div class="handover-chips"></div>
          <ul class="handover-log"></ul>
          <div class="handover-clear">
            <button type="button" class="handover-clear-btn">メモを全部消す</button>
          </div>
        </div>
      </section>

      <!-- 3〜5時 -->
      <section id="t3-5" class="slot">
        <div class="slot-header">
          <div class="slot-title">3:00〜5:00</div>
          <div class="slot-note">早朝</div>
        </div>

        <div class="tasks-group">
          <h3><span class="badge badge-a">A 必須</span> この時間に必ずやること</h3>
          <ul class="tasks a">
            <li><label class="task-item"><input type="checkbox"><span class="task-text">朝刊納品・片づけ</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">品出し（全商品）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">品出し（チルド飲料）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">棚滑り掃除（1台）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">ホット・常温FF作成（朝）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">中華まん作成（朝）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">CDC納品・片づけ（2便）</span></label></li>
            <li><label class="task-item"><input type="checkbox"><span class="task-text">4時オープンケース廃棄（米飯・長鮮手巻・チルド弁当…）</span></label></li>
          </ul>
        </div>

        <div class="tasks-group">
          <h3><span class="badge badge-b">B 余裕</span> 時間が余ったときにできたら助かること</h3>
          <ul class="tasks b">
            <li><label class="task-item"><input type="checkbox"><span class="task-text">余裕があれば：前陳・清掃を追加</span></label></li>
          </ul>
        </div>
      </section>

      <!-- 3〜5時後の引き継ぎメモ -->
      <section class="slot handover-slot" data-slot="t3-5">
        <div class="slot-header">
          <div class="slot-title">引き継ぎメモ（全員で共有）</div>
          <div class="slot-note">時間帯をまたぐ時の共有メモ</div>
        </div>

        <div class="handover">
          <p class="handover-note">
            文章を書くのがだるい人向け。下のボタンをタップするとメモに追加されます。
          </p>
          <div class="handover-chips"></div>
          <ul class="handover-log"></ul>
          <div class="handover-clear">
            <button type="button" class="handover-clear-btn">メモを全部消す</button>
          </div>
        </div>
      </section>

    </main>

    <div class="footer-note">
      迷ったら：Aタスク → 前陳 → 清掃 の順で動けばOK。
    </div>
  </div>

   <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore-compat.js"></script>

  <script>
    // =============================
    // Firebase 設定（ここは今まで通り）
    // =============================
    const firebaseConfig = {
      apiKey: "AIzaSyAPBMvTpzKCcPxLETncBqVR8fzf0cqKirc",
      authDomain: "lawson-workflow.firebaseapp.com",
      projectId: "lawson-workflow",
      storageBucket: "lawson-workflow.firebasestorage.app",
      messagingSenderId: "335371795694",
      appId: "1:335371795694:web:3b0950a616d368b284c7ff",
      measurementId: "G-BGENZNZMRC"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // =============================
    // 営業日キー計算（6:00切り替え）
    // =============================
    function getCurrentBusinessKey() {
      const now = new Date(); // 店のPCが日本時間ならそのままJST
      const y = now.getFullYear();
      const m = now.getMonth();
      const d = now.getDate();

      const base = new Date(y, m, d);

      // 0:00〜5:59 は「前日扱い」
      if (now.getHours() < 6) {
        base.setDate(base.getDate() - 1);
      }

      const yy = base.getFullYear();
      const mm = String(base.getMonth() + 1).padStart(2, '0');
      const dd = String(base.getDate()).padStart(2, '0');
      return `${yy}-${mm}-${dd}`; // 例: "2025-11-22"
    }

    /****************************************************
     * 🔥 6:00 自動切り替え（超シンプル版：ページ再読み込み）
     ****************************************************/
    function setupDailyResetAt6AM() {
      function scheduleNextReset() {
        const now = new Date();
        const next = new Date();

        // 次の 6:00 を計算
        next.setHours(6, 0, 0, 0);
        if (now >= next) {
          next.setDate(next.getDate() + 1); // 今日の6時を過ぎてたら翌日
        }

        const ms = next - now;
        console.log('次の 6:00 リセットまで:', ms / 1000 / 60, '分');

        setTimeout(() => {
          console.log('🔥 6:00到達 → 営業日切替のためページを再読み込み');
          on6amReset();
          scheduleNextReset(); // 次の日の 6:00 もセット
        }, ms);
      }

      scheduleNextReset();
    }

    function on6amReset() {
      // businessKey や handover の listener を全部切り替えるには
      // 再読み込みが一番安全＆シンプル
      location.reload();
    }

    // =============================
    // DOM 準備できたらセットアップ
    // =============================
    document.addEventListener('DOMContentLoaded', () => {


      // =============================
      // 現在時刻の時間帯セクションに自動スクロール
      // =============================
      function getCurrentSlotIdByHour(hour) {
        if (hour >= 6 && hour < 9)  return 't6-8';
        if (hour >= 9 && hour < 12) return 't9-11';
        if (hour >= 12 && hour < 15) return 't12-14';
        if (hour >= 15 && hour < 18) return 't15-17';
        if (hour >= 18 && hour < 21) return 't18-20';
        if (hour >= 21 && hour < 24) return 't21-23';
        if (hour >= 0 && hour < 2)   return 't0-2';
        return 't3-5'; // 2〜3, 3〜5 はここ
      }

      function scrollToCurrentTimeSlot() {
  const now = new Date();
  const h = now.getHours();
  const slotId = getCurrentSlotIdByHour(h);
  const el = document.getElementById(slotId);
  if (!el) return;

  setTimeout(() => {
    // 固定ヘッダーの高さを取得（クラス名は自分のコードに合わせてね）
    const header = document.querySelector('.top-bar') || document.querySelector('header');
    const headerHeight = header ? header.offsetHeight : 80; // なければだいたい80px

    const rect = el.getBoundingClientRect();
    const targetY = rect.top + window.scrollY - headerHeight - 10; // ちょい余裕を引く

    window.scrollTo({
      top: targetY,
      behavior: 'smooth'
    });
  }, 400);
}


      // 画面表示時に「今の時間帯」まで自動スクロール
      scrollToCurrentTimeSlot();


      

      // =============================
      // 端末ラベル管理（localStorage）
      // =============================
      const DEVICE_LABEL_KEY = "nb_lawson_device_label";
      const deviceLabelDisplay = document.getElementById("deviceLabelDisplay");
      const deviceLabelInput   = document.getElementById("deviceLabelInput");
      const deviceLabelSaveBtn = document.getElementById("deviceLabelSaveBtn");

      let currentDeviceLabel = "未設定";

      function loadDeviceLabel() {
        const saved = localStorage.getItem(DEVICE_LABEL_KEY);
        if (saved && saved.trim() !== "") {
          currentDeviceLabel = saved.trim();
          if (deviceLabelDisplay) deviceLabelDisplay.textContent = currentDeviceLabel;
          if (deviceLabelInput)   deviceLabelInput.value = currentDeviceLabel;
        } else {
          currentDeviceLabel = "未設定";
          if (deviceLabelDisplay) deviceLabelDisplay.textContent = "未設定";
        }
      }

      function saveDeviceLabel() {
        if (!deviceLabelInput) return;
        const value = deviceLabelInput.value.trim();
        if (!value) {
          alert("端末ラベルを入力してください（例：レジ横iPad）");
          return;
        }
        currentDeviceLabel = value;
        localStorage.setItem(DEVICE_LABEL_KEY, value);
        if (deviceLabelDisplay) deviceLabelDisplay.textContent = value;
      }

      deviceLabelSaveBtn?.addEventListener("click", saveDeviceLabel);
      deviceLabelInput?.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          e.preventDefault();
          saveDeviceLabel();
        }
      });

      // 初期ロード時に端末ラベル読み込み
      loadDeviceLabel();

      // =============================
      // 🔤 文字サイズ：ボタンと保存処理
      // =============================
      const sizeButtons = document.querySelectorAll('.font-size-selector button');

      function applyFontSize(size) {
        document.body.classList.remove('font-medium', 'font-large');
        if (size === 'medium') {
          document.body.classList.add('font-medium');
        } else if (size === 'large') {
          document.body.classList.add('font-large');
        }
        // ボタンの active 切り替え
        sizeButtons.forEach(btn => {
          btn.classList.toggle('active', btn.dataset.size === size);
        });
        localStorage.setItem('fontSizeSetting', size);
      }

      sizeButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          const size = btn.dataset.size || 'small';
          applyFontSize(size);
        });
      });

      const savedSize = localStorage.getItem('fontSizeSetting') || 'small';
      applyFontSize(savedSize);

      // 🔥 朝6:00 自動リセット開始
      setupDailyResetAt6AM();

      // =============================
      // 現在時刻・営業日・次リセット表示
      // =============================
      const timeDisplay = document.getElementById('time-display');

      function updateTimeDisplay() {
        if (!timeDisplay) return;

        const now = new Date();
        const jp = now.toLocaleString('ja-JP', {
          year: 'numeric',
          month: '2-digit',
          day: '2-digit',
          weekday: 'short',
          hour: '2-digit',
          minute: '2-digit',
          second: '2-digit'
        });

        const businessKey = getCurrentBusinessKey();

        // 次の 6:00 を計算
        let nextReset = new Date();
        nextReset.setHours(6, 0, 0, 0);
        if (now >= nextReset) {
          nextReset.setDate(nextReset.getDate() + 1);
        }
        const nextResetStr = nextReset.toLocaleString('ja-JP', {
          month: '2-digit',
          day: '2-digit',
          weekday: 'short',
          hour: '2-digit',
          minute: '2-digit'
        });

        timeDisplay.innerHTML = `
          <div><strong>現在時刻：</strong> ${jp}</div>
          <div><strong>今日の営業日：</strong> ${businessKey}（6:00切替）</div>
          <div><strong>次のリセット：</strong> ${nextResetStr}</div>
        `;
      }

      updateTimeDisplay();
      setInterval(updateTimeDisplay, 1000);

      // --------------------------------
      // 1) タスク定義（taskSlots）からチェックリストを生成
      // --------------------------------
      const timeSlotIds = ['t6-8', 't9-11', 't12-14', 't15-17', 't18-20', 't21-23', 't0-2', 't3-5'];
      const checkboxMap = new Map();        // taskId -> checkbox
      let latestCheckedIds = new Set();     // Firestore から来たチェック済みID
      const taskDocRef = db.collection('tasks').doc('lawson-main');
      let applyingRemote = false;

      function buildTasksFromDefinition(slotId, ul, tasks, groupLabel) {
        ul.innerHTML = '';
        tasks.forEach((text, index) => {
          const li = document.createElement('li');
          li.innerHTML = `
            <label class="task-item">
              <input type="checkbox">
              <span class="task-text"></span>
            </label>
          `;
          const cb   = li.querySelector('input[type="checkbox"]');
          const span = li.querySelector('.task-text');
          span.textContent = text;

          const taskId = `${slotId}-${groupLabel}-${index}`;
          cb.dataset.taskId = taskId;
          checkboxMap.set(taskId, cb);

          cb.checked = latestCheckedIds.has(taskId);

          ul.appendChild(li);
        });
      }

      async function loadTaskDefinitions() {
        const taskSlotsRef = db.collection('taskSlots');

        await Promise.all(
          timeSlotIds.map(async (slotId) => {
            const section = document.getElementById(slotId);
            if (!section) return;

            const ulA = section.querySelector('ul.tasks.a');
            const ulB = section.querySelector('ul.tasks.b');
            if (!ulA || !ulB) return;

            try {
              const snap = await taskSlotsRef.doc(slotId).get();
              if (snap.exists) {
                const data = snap.data() || {};
                const tasksA = data.tasksA || [];
                const tasksB = data.tasksB || [];

                buildTasksFromDefinition(slotId, ulA, tasksA, 'A');
                buildTasksFromDefinition(slotId, ulB, tasksB, 'B');
              } else {
                // Firestore に定義が無いとき：いま HTML に書かれている li から taskId を振る
                const setupFromExisting = (ul, groupLabel) => {
                  const lis = ul.querySelectorAll('li');
                  lis.forEach((li, index) => {
                    const cb = li.querySelector('input[type="checkbox"]');
                    if (!cb) return;
                    const taskId = `${slotId}-${groupLabel}-${index}`;
                    cb.dataset.taskId = taskId;
                    checkboxMap.set(taskId, cb);
                    cb.checked = latestCheckedIds.has(taskId);
                  });
                };
                setupFromExisting(ulA, 'A');
                setupFromExisting(ulB, 'B');
              }
            } catch (e) {
              console.error('タスク定義読み込みエラー:', slotId, e);
            }
          })
        );
      }

      // --------------------------------
      // 2) チェック状態 ↔ Firestore 同期
      // --------------------------------
      function saveTasksToFirestore() {
        const checkedIds = [];
        checkboxMap.forEach((cb, id) => {
          if (cb.checked) checkedIds.push(id);
        });
        const businessKey = getCurrentBusinessKey();
        taskDocRef.set(
          { checkedIds, businessKey },
          { merge: true }
        );
      }

      taskDocRef.onSnapshot((doc) => {
        const data = doc.exists ? doc.data() : {};
        const storedKey  = data.businessKey;
        const currentKey = getCurrentBusinessKey();

        if (storedKey !== currentKey) {
          taskDocRef.set(
            { checkedIds: [], businessKey: currentKey },
            { merge: true }
          );
          latestCheckedIds = new Set();
        } else {
          latestCheckedIds = new Set(data.checkedIds || []);
        }

        applyingRemote = true;
        checkboxMap.forEach((cb, id) => {
          cb.checked = latestCheckedIds.has(id);
        });
        applyingRemote = false;
      });

      // =============================
      // ✅ 自動ログ共通関数（端末ラベル込み）
      // =============================
      async function logChecklistAction({ taskId, taskLabel, action, extra }) {
        try {
          await db.collection("checklistLogs").add({
            taskId: taskId ?? null,
            taskLabel: taskLabel ?? null,
            action: action, // "check" / "uncheck" / "note-save" など
            deviceLabel: currentDeviceLabel || "未設定",
            businessKey: getCurrentBusinessKey(),
            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
            clientTimeISO: new Date().toISOString(),
            extra: extra ?? null
          });
        } catch (err) {
          console.error("ログ保存エラー:", err);
        }
      }

      // ✅ チェックボックス変更 → Firestore保存 ＋ 自動ログ
      document.body.addEventListener('change', (e) => {
        const target = e.target;
        if (!target.matches('input[type="checkbox"][data-task-id]')) return;
        if (applyingRemote) return; // リアルタイム反映中はログ取らない

        // Firestoreにチェック状態を保存
        saveTasksToFirestore();

        const taskId = target.dataset.taskId || null;
        const taskLabel =
          target.closest(".task-item")?.querySelector(".task-text")?.textContent ||
          null;

        logChecklistAction({
          taskId,
          taskLabel,
          action: target.checked ? "check" : "uncheck"
        });
      });

      // 先にタスク定義をロード
      loadTaskDefinitions();

      // --------------------------------
      // 3) 引き継ぎメモ（時間帯ごと）
      // --------------------------------
      const handoverSlots  = document.querySelectorAll('.handover-slot');
      const handoverColRef = db.collection('handover');

      function renderHandoverForSlot(snapshot, logEl, slotId) {
        if (!logEl) return;

        logEl.innerHTML = '';

        if (snapshot.empty) {
          const li = document.createElement('li');
          li.textContent = 'まだ引き継ぎメモはありません。';
          li.style.fontSize = '0.9em';
          li.style.color = '#999';
          logEl.appendChild(li);
          return;
        }

        const docs = [];
        snapshot.forEach((doc) => {
          docs.push(doc);
        });

        docs.sort((a, b) => {
          const da = a.data().createdAt ? a.data().createdAt.toMillis() : 0;
          const db = b.data().createdAt ? b.data().createdAt.toMillis() : 0;
          return db - da;
        });

        docs.forEach((doc) => {
          const data = doc.data();
          if (data.slotId !== slotId) return;

          const li = document.createElement('li');
          li.className = 'handover-item';

          const textSpan = document.createElement('span');
          textSpan.className = 'handover-text';
          textSpan.textContent = data.text || '';

          const timeSpan = document.createElement('span');
          timeSpan.className = 'handover-time';
          timeSpan.textContent = data.timeLabel || '';

          const delBtn = document.createElement('button');
          delBtn.className = 'handover-remove';
          delBtn.textContent = '✕';
          delBtn.addEventListener('click', () => {
            doc.ref.delete();
          });

          li.appendChild(textSpan);
          li.appendChild(timeSpan);
          li.appendChild(delBtn);

          logEl.appendChild(li);
        });
      }

      handoverSlots.forEach((slotEl) => {
        const slotId    = slotEl.dataset.slot || 'global';
        const logEl     = slotEl.querySelector('.handover-log');
        const clearBtn  = slotEl.querySelector('.handover-clear-btn');
        const chipsArea = slotEl.querySelector('.handover-chips');

        handoverColRef
          .where('businessKey', '==', getCurrentBusinessKey())
          .where('slotId', '==', slotId)
          .onSnapshot((snapshot) => {
            renderHandoverForSlot(snapshot, logEl, slotId);
          });

        function addHandoverForSlot(text) {
          const now = new Date();
          const timeLabel = now.toLocaleTimeString('ja-JP', {
            hour: '2-digit',
            minute: '2-digit'
          });

          const businessKey = getCurrentBusinessKey();

          handoverColRef.add({
            text,
            slotId,
            businessKey,
            timeLabel,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
          });
        }

        if (chipsArea) {
          db.collection("handoverTemplates")
            .doc("global")
            .get()
            .then((doc) => {
              chipsArea.innerHTML = "";
              if (!doc.exists) return;

              const chips = doc.data().chips || [];
              chips.forEach((text) => {
                const btn = document.createElement("button");
                btn.className = "handover-chip";
                btn.textContent = text;
                btn.dataset.text = text;

                btn.addEventListener("click", () => {
                  addHandoverForSlot(text);
                });

                chipsArea.appendChild(btn);
              });
            })
            .catch((e) => {
              console.error("handoverTemplates 読み込みエラー", e);
            });
        }

        if (clearBtn) {
          clearBtn.addEventListener('click', async () => {
            if (!confirm('この時間帯の引き継ぎメモを全部消しますか？')) return;

            const businessKey = getCurrentBusinessKey();

            const snap = await handoverColRef
              .where('slotId', '==', slotId)
              .where('businessKey', '==', businessKey)
              .get();

            if (snap.empty) return;

            const batch = db.batch();
            snap.forEach((doc) => batch.delete(doc.ref));
            await batch.commit();
          });
        }
      });

      // --------------------------------
      // 4) 経営者お知らせ（ownerNews）読み込み
      // --------------------------------
      const infoListEl = document.querySelector('.info-list');
      if (infoListEl) {
        const ownerNewsColRef = db.collection('ownerNews');

        ownerNewsColRef
          .orderBy('createdAt', 'desc')
          .limit(5)
          .onSnapshot(
            (snapshot) => {
              infoListEl.innerHTML = '';

              if (snapshot.empty) {
                const li = document.createElement('li');
                li.textContent = '現在、お知らせはありません。';
                infoListEl.appendChild(li);
                return;
              }

              snapshot.forEach((doc) => {
                const data = doc.data();
                const title = data.title || '';
                const body  = data.body  || '';

                const li = document.createElement('li');
                if (title && body) {
                  li.textContent = `【${title}】 ${body}`;
                } else if (title) {
                  li.textContent = `【${title}】`;
                } else {
                  li.textContent = body || '';
                }
                infoListEl.appendChild(li);
              });
            },
            (error) => {
              console.error('ownerNews 読み込みエラー', error);
              infoListEl.innerHTML = '';
              const li = document.createElement('li');
              li.textContent = 'お知らせの読み込みに失敗しました。';
              infoListEl.appendChild(li);
            }
          );
      }
    });
  </script>








  
</body>
</html>
